header:
  version: 19
  includes:
  - yml/mender-full.yml
  - yml/arm.yml
  - yml/ti.yml

machine: beagleplay-ti

local_conf_header:
  beagleplay: |
    MENDER_STORAGE_DEVICE = "/dev/mmcblk0"
    MENDER_STORAGE_TOTAL_SIZE_MB = "14000"
    MENDER_PARTITION_ALIGNMENT = "1048576"
    MENDER_RESERVED_SPACE_BOOTLOADER_DATA = "0"
    MENDER_UBOOT_ENV_STORAGE_DEVICE_OFFSET = ""
    MENDER_UBOOT_CONFIG_SYS_MMC_ENV_PART = "1"
    MENDER_UBOOT_MMC_ENV_LINUX_DEVICE_PATH = "${MENDER_STORAGE_DEVICE}boot0"
    MENDER_UBOOT_MMC_ENV_LINUX_DEVICE_PATH_REDUND = "${MENDER_STORAGE_DEVICE}boot1"
    MENDER_UBOOT_ENV_STORAGE_DEVICE_OFFSET_1 = "0x0"
    MENDER_UBOOT_ENV_STORAGE_DEVICE_OFFSET_2 = "0x0"
    MENDER_SERVER_URL = "https://hosted.mender.io"
    MENDER_TENANT_TOKEN = "MENDER_TENANT_TOKEN_SLUG"
    EXTRA_IMAGE_FEATURES += "debug-tweaks package-management"
    IMAGE_FSTYPES:remove = "wic wic.bmap mender.bmap sdimg sdimg.bmap uefi uefi.bmap"
    IMAGE_ROOTFS_EXTRA_SPACE = "3000000"
    CORE_IMAGE_EXTRA_INSTALL += "btop minicom python3 python3-pyserial setserial"
    
  mender-artifact: |
    MENDER_ARTIFACT_NAME = "${IMAGE_BASENAME}-${MACHINE}-UUID_SLUG"

  bitbake-caching: |
    BB_HASHSERVE_UPSTREAM = "wss://hashserv.yoctoproject.org/ws"
    SSTATE_MIRRORS ?= "file://.* http://sstate.yoctoproject.org/all/PATH;downloadfilename=PATH"
    BB_HASHSERVE = "auto"
    BB_SIGNATURE_HANDLER = "OEEquivHash"

target:
  - core-image-full-cmdline
